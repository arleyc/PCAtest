<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>PCAtest: Statistical significance of PCA â€¢ PCAtest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PCAtest: Statistical significance of PCA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PCAtest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/my-vignette.html">PCAtest: Statistical significance of PCA</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PCAtest: Statistical significance of PCA</h1>
            
      

      <div class="d-none name"><code>my-vignette.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A PCA is meaningful and should only be applied if there is a
significant correlation structure among at least some of the variables
in a dataset. Due to sampling variance alone, it is possible that some
level of random correlation structure could occur in the data.
Therefore, it is necessary to evaluate if the observed correlation
structure is higher than expected due to chance alone.</p>
<p>PCAtest uses a pair of statistics, Psi and Phi, based on the
eigenvalues (roots) of a PCA to evaluate its significance by comparing
observed values with their null distributions. The expected values of
Psi and Phi are calculated from random permutations of the observations
within variables, which effectively removes any correlation structure
among variables. If the observed statistics are not larger than the
expected null distributions, PCA is meaningless and it should not be
used.</p>
<p>If the null hypothesis of a non-significant PCA is rejected, then
PCAtest calculates the observed eigenvalues and builds null
distributions to select the number of significant PCs. In addition,
PCAtest also calculates two other statistics: the index of the loadings
and the correlations of each PC with the variables, to test the
contribution of the observed variables to each significant PC.</p>
</div>
<div class="section level2">
<h2 id="overall-significance-of-a-pca">Overall significance of a PCA<a class="anchor" aria-label="anchor" href="#overall-significance-of-a-pca"></a>
</h2>
<p>PCAtest should not reject the null hypothesis of a non-significant
PCA, if there is no correlation structure among the variables. We can
generate and analyze in PCAtest a set of uncorrelated variables:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://arleyc.github.io/PCAtest/">PCAtest</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">ex0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span> <span class="op">)</span></span>
<span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ex0</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling bootstrap replicates... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling random permutations... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Test of PCA significance: 5 variables, 100 observations</span></span>
<span><span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical Psi = 0.2505, Max null Psi = 0.4141, Min null Psi = 0.0363, p-value = 0.15</span></span>
<span><span class="co">#&gt; Empirical Phi = 0.1119, Max null Phi = 0.1439, Min null Phi = 0.0426, p-value = 0.15</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PCA is not significant!</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-2-1.png" width="80%" height="80%"></p>
</div>
<div class="section level2">
<h2 id="selecting-the-number-of-significant-pcs">Selecting the number of significant PCs<a class="anchor" aria-label="anchor" href="#selecting-the-number-of-significant-pcs"></a>
</h2>
<p>If a PCA is significant, PCAtest uses random permutations to test
which PC axes are significant based on random permutation and
calculation of the percentage of total variation explained by each PC
axis. We can use the published dataset from Wong &amp; Carmona (2021, <a href="https://doi.org/10.1111/2041-210X.13568" class="external-link uri">https://doi.org/10.1111/2041-210X.13568</a>) consisting of
seven morphological variables measured in 29 ant species:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling bootstrap replicates... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling random permutations... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span></span>
<span><span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.4335, Min null Psi = 0.7399, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2407, Min null Phi = 0.1327, p-value = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.20197, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.66424, p-value = 0.18</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.38726, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.16479, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.92378, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.76744, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.53648, p-value = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:40-63.6) of the total variation</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-3-1.png" width="80%" height="80%"></p>
</div>
<div class="section level2">
<h2 id="testing-which-variables-have-significant-loadings">Testing which variables have significant loadings<a class="anchor" aria-label="anchor" href="#testing-which-variables-have-significant-loadings"></a>
</h2>
<p>In addition to selecting the number of significant PC axes, we are
usually interested in finding out which variables have significant
loadings on each significant PC axis. PCAtest runs random permutations
and plots index loadings for all significant PCs:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">TRUE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling bootstrap replicates... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling random permutations... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span></span>
<span><span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.4714, Min null Psi = 0.5735, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2426, Min null Phi = 0.1169, p-value = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.23241, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.71318, p-value = 0.11</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.3766, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.14496, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.93756, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.7892, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.62112, p-value = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:39.3-65.1) of the total variation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables 1, 2, 3, 4, 5, and 7 have significant loadings on PC 1</span></span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-4-1.png" width="80%" height="80%"></p>
</div>
<div class="section level2">
<h2 id="testing-which-variables-have-significant-correlations">Testing which variables have significant correlations<a class="anchor" aria-label="anchor" href="#testing-which-variables-have-significant-correlations"></a>
</h2>
<p>Instead of index loadings, we can choose to use variable correlations
to evaluate their contributions to each significant PC axis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span></span>
<span><span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">TRUE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling bootstrap replicates... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Sampling random permutations... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span></span>
<span><span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span></span>
<span><span class="co">#&gt; ========================================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.7018, Min null Psi = 0.5938, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2536, Min null Phi = 0.1189, p-value = 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.16286, p-value = 0</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.6875, p-value = 0.23</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.44721, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.12624, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.94865, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.75295, p-value = 1</span></span>
<span><span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.64223, p-value = 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:44.7-66.3) of the total variation</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Variables 2, and 3 have significant correlations with PC 1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arley Camargo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
