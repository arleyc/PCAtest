<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PCAtest: Statistical Significance of PCA — PCAtest • PCAtest</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PCAtest: Statistical Significance of PCA — PCAtest"><meta property="og:description" content="PCAtest uses random permutations to build null distributions for
several statistics of a PCA analysis: Psi (Vieira 2012), Phi (Gleason and
Staelin 1975), the rank-of-roots (ter Braak 1988), the index of the
loadings (Vieira 2012), and the correlations of the PC with the variables
(Jackson 1991). Comparing these distributions with the observed values of
the statistics, the function tests: (1) the hypothesis that there is more
correlational structure among the observed variables than expected by
random chance, (2) the statistical significance of each PC, and (3) the
contribution of each observed variable to each significant PC. The
function also calculates the sampling variance around mean observed
statistics based on bootstrap replicates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCAtest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/my-vignette.html">PCAtest: Statistical significance of PCA</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PCAtest: Statistical Significance of PCA</h1>
    
    <div class="hidden name"><code>PCAtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>PCAtest uses random permutations to build null distributions for
several statistics of a PCA analysis: Psi (Vieira 2012), Phi (Gleason and
Staelin 1975), the rank-of-roots (ter Braak 1988), the index of the
loadings (Vieira 2012), and the correlations of the PC with the variables
(Jackson 1991). Comparing these distributions with the observed values of
the statistics, the function tests: (1) the hypothesis that there is more
correlational structure among the observed variables than expected by
random chance, (2) the statistical significance of each PC, and (3) the
contribution of each observed variable to each significant PC. The
function also calculates the sampling variance around mean observed
statistics based on bootstrap replicates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PCAtest</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  nboot <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  indload <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  varcorr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  counter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>A matrix or dataframe with variables in the columns and the observations in the rows.</p></dd>


<dt>nperm</dt>
<dd><p>Number of random permutations to build null distributions of the statistics.</p></dd>


<dt>nboot</dt>
<dd><p>Number of bootstrap replicates to build 95%-confidence intervals of the observed statistics.</p></dd>


<dt>alpha</dt>
<dd><p>Nominal alpha level for statistical tests.</p></dd>


<dt>indload</dt>
<dd><p>A logical indicating whether to calculate the index loadings of the variables with the significant PCs.</p></dd>


<dt>varcorr</dt>
<dd><p>A logical indicating whether to calculate the correlations of the variables with the significant PCs.</p></dd>


<dt>counter</dt>
<dd><p>A logical specifying whether to show the progress of the random sampling (bootstrap and permutations) on the screen.</p></dd>


<dt>plot</dt>
<dd><p>A logical specifying whether to plot the null distributions, observed statistics, and 95%-confidence intervals of statistics based on random permutation and bootstrap resampling.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class “list” with the following elements:</p><dl><dt>psiobs</dt>
<dd><p>The observed Psi statistic.</p></dd>


<dt>phiobs</dt>
<dd><p>The observed Phi statistic.</p></dd>


<dt>psi</dt>
<dd><p>The null distribution of Psi values.</p></dd>


<dt>phi</dt>
<dd><p>The null distribution of Phi values.</p></dd>


<dt>pervarobs</dt>
<dd><p>The percentage of variance explained by each PC based on the observed data.</p></dd>


<dt>pervarboot</dt>
<dd><p>The percentage of variance explained by each PC based on the bootstrapped data.</p></dd>


<dt>pervarbootci</dt>
<dd><p>Confidence intervals of the percentage of variance explained by each PC based on the bootstrapped data.</p></dd>


<dt>pervarperm</dt>
<dd><p>The percentage of variance explained by each PC based on the randomized data.</p></dd>


<dt>pervarpermci</dt>
<dd><p>Confidence intervals of the percentage of variance explained by each PC based on the randomized data.</p></dd>


<dt>indexloadobs</dt>
<dd><p>The index of the loadings of the observed data.</p></dd>


<dt>indexloadboot</dt>
<dd><p>The index of the loadings of the bootstrapped data.</p></dd>


<dt>indexloadbootci</dt>
<dd><p>Confidence intervals of the index of the loadings based on the bootstrapped data.</p></dd>


<dt>indexloadperm</dt>
<dd><p>The index of the loadings based on the randomized data.</p></dd>


<dt>indexloadpermci</dt>
<dd><p>Confidence intervals of the index of the loadings based on the randomized data.</p></dd>


<dt>corobs</dt>
<dd><p>If varcorr=TRUE, the correlations of the observed variables with each significant PC.</p></dd>


<dt>corboot</dt>
<dd><p>If varcorr=TRUE, the correlations of the observed variables with each significant PC based on the bootstrapped data.</p></dd>


<dt>corbootci</dt>
<dd><p>If varcorr=TRUE, the confidence intervals of the correlations of the variables with each significant PC based on the bootstrapped data.</p></dd>


<dt>corperm</dt>
<dd><p>If varcorr=TRUE, the correlations of the observed variables with each significant PC based on randomized data.</p></dd>


<dt>corpermci</dt>
<dd><p>If varcorr=TRUE, the confidence intervals of the correlations of the variables with each significant PC based on randomized data.</p></dd>



</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>PCAtest uses the function stats::prcomp to run a PCA using
the arguments scale = TRUE and center = TRUE.
PCAtest plots four types of graphs in a single page: (1) a histogram showing the null distribution and the observed value of the Psi statistic, (2) a histogram showing the null distribution and the observed value of the Phi statistic, (3) a bar plot of the percentage of explained variance of each PC1, PC2, ..., etc., showing the sampling variance based on bootstrap replicates and random permutations with 95%-confidence intervals, and (4) a bar plot of the index of the loadings of each observed variable for PC1, showing the sampling variance of bootstrap replicates and random permutations with 95%- confidence intervals. If more than one PC is significant, additional plots for the index of the loadings are shown in as many new pages as necessary given the number of significant PCs. If the PCA is not significant, based on the Psi and Phi testing results, only histograms (1) and (2) are shown.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ul><li><p>Gleason, T. C. and Staelin R. (1975) A proposal for handling missing data. Psychometrika, 40, 229–252.</p></li>
<li><p>Jackson, J. E. (1991) A User’s Guide to Principal Components. John Wiley &amp; Sons, New York, USA.</p></li>
<li><p>Ringnér, M. (2008) What is principal component analysis? Nature Biotechnology, 26, 303–304.</p></li>
<li><p>ter Braak, C. F. J. (1990) Update notes: CANOCO (version 3.1). Agricultural Mattematic Group, Report LWA-88-02, Wagningen, Netherlands.</p></li>
<li><p>Vieira, V. M. N. C. S. (2012) Permutation tests to estimate significances on Principal Components Analysis. Computational Ecology and Software, 2, 103–123.</p></li>
<li><p>Wong, M. K. L. and Carmona, C. P. (2021) Including intraspecific trait variability to avoid distortion of functional diversity and ecological inference: Lessons from natural assemblages. Methods in Ecology and Evolution. <a href="https://doi.org/10.1111/2041-%20210X.13568" class="external-link">https://doi.org/10.1111/2041- 210X.13568</a>.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Arley Camargo</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#PCA analysis of five uncorrelated (r=0) variables</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">&lt;-</span><span class="fu">PCAtest</span><span class="op">(</span><span class="va">ex0</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling bootstrap replicates... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling random permutations... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparing empirical statistics with their null distributions... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of PCA significance: 5 variables, 100 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 bootstrap replicates, 100 random permutations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Psi = 0.2505, Max null Psi = 0.4141, Min null Psi = 0.0363, p-value = 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Phi = 0.1119, Max null Phi = 0.1439, Min null Phi = 0.0426, p-value = 0.15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PCA is not significant!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#PCA analysis of five correlated (r=0.25) variables</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.25</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex025</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">&lt;-</span><span class="fu">PCAtest</span><span class="op">(</span><span class="va">ex025</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="PCAtest-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling bootstrap replicates... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling random permutations... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparing empirical statistics with their null distributions... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of PCA significance: 5 variables, 100 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 bootstrap replicates, 100 random permutations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Psi = 2.1804, Max null Psi = 0.4778, Min null Psi = 0.0492, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Phi = 0.3302, Max null Phi = 0.1546, Min null Phi = 0.0496, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #1 = 2.30804, Max null eigenvalue = 1.5466, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #2 = 0.80389, Max null eigenvalue = 1.24958, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #3 = 0.73566, Max null eigenvalue = 1.09736, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #4 = 0.60667, Max null eigenvalue = 0.98087, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #5 = 0.54573, Max null eigenvalue = 0.85232, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC 1 is significant and accounts for 46.2% (95%-CI:38.4-52.9) of the total variation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables 1, 2, 3, 4, and 5 have significant loadings on PC 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="PCAtest-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#PCA analysis of five correlated (r=0.5) variables</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ex05</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html" class="external-link">mvrnorm</a></span><span class="op">(</span><span class="fl">100</span>, mu <span class="op">=</span> <span class="va">mu</span>, Sigma <span class="op">=</span> <span class="va">Sigma</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">&lt;-</span><span class="fu">PCAtest</span><span class="op">(</span><span class="va">ex05</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling bootstrap replicates... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling random permutations... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparing empirical statistics with their null distributions... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of PCA significance: 5 variables, 100 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 bootstrap replicates, 100 random permutations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Psi = 4.9048, Max null Psi = 0.4322, Min null Psi = 0.0657, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Phi = 0.4952, Max null Phi = 0.1470, Min null Phi = 0.0573, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #1 = 2.97328, Max null eigenvalue = 1.47123, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #2 = 0.65712, Max null eigenvalue = 1.22526, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #3 = 0.52237, Max null eigenvalue = 1.11605, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #4 = 0.44435, Max null eigenvalue = 0.969, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #5 = 0.40288, Max null eigenvalue = 0.83816, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC 1 is significant and accounts for 59.5% (95%-CI:51.4-67.9) of the total variation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables 1, 2, 3, 4, and 5 have significant loadings on PC 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="PCAtest-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#PCA analysis of seven morphological variables from 29 ant species (from</span></span></span>
<span class="r-in"><span><span class="co">#Wong and Carmona 2021, https://doi.org/10.1111/2041-210X.13568)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span><span class="op">&lt;-</span><span class="fu">PCAtest</span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling bootstrap replicates... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling random permutations... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparing empirical statistics with their null distributions... Please wait</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of PCA significance: 7 variables, 29 observations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 bootstrap replicates, 100 random permutations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ========================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Psi = 10.9186, Max null Psi = 3.0303, Min null Psi = 0.6274, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical Phi = 0.5099, Max null Phi = 0.2686, Min null Phi = 0.1222, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.33045, p-value = 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.63299, p-value = 0.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.4709, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.10378, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.91727, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.77857, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.55742, p-value = 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PC 1 is significant and accounts for 55% (95%-CI:43.3-65.5) of the total variation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variables 1, 2, 3, 4, 5, and 7 have significant loadings on PC 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-plt img"><img src="PCAtest-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arley Camargo.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

