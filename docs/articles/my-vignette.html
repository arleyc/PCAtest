<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PCAtest: Statistical significance of PCA â€¢ PCAtest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PCAtest: Statistical significance of PCA">
<meta property="og:description" content="PCAtest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PCAtest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/my-vignette.html">PCAtest: Statistical significance of PCA</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="my-vignette_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>PCAtest: Statistical significance of PCA</h1>
            
      
      
      <div class="hidden name"><code>my-vignette.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>A PCA is meaningful and should only be applied if there is a significant correlation structure among at least some of the variables in a dataset. Due to sampling variance alone, it is possible that some level of random correlation structure could occur in the data. Therefore, it is necessary to evaluate if the observed correlation structure is higher than expected due to chance alone.</p>
<p>PCAtest uses a pair of statistics, Psi and Phi, based on the eigenvalues (roots) of a PCA to evaluate its significance by comparing observed values with their null distributions. The expected values of Psi and Phi are calculated from random permutations of the observations within variables, which effectively removes any correlation structure among variables. If the observed statistics are not larger than the expected null distributions, PCA is meaningless and it should not be used.</p>
<p>If the null hypothesis of a non-significant PCA is rejected, then PCAtest calculates the observed eigenvalues and builds null distributions to select the number of significant PCs. In addition, PCAtest also calculates two other statistics: the index of the loadings and the correlations of each PC with the variables, to test the contribution of the observed variables to each significant PC.</p>
</div>
<div id="overall-significance-of-a-pca" class="section level2">
<h2 class="hasAnchor">
<a href="#overall-significance-of-a-pca" class="anchor"></a>Overall significance of a PCA</h2>
<p>PCAtest should not reject the null hypothesis of a non-significant PCA, if there is no correlation structure among the variables. We can generate and analyze in PCAtest a set of uncorrelated variables:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">PCAtest</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ex0"</span><span class="op">)</span>
<span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ex0</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling bootstrap replicates... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling random permutations... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; Test of PCA significance: 5 variables, 100 observations</span>
<span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical Psi = 0.1691, Max null Psi = 0.4499, Min null Psi = 0.0358, p-value = 0.51</span>
<span class="co">#&gt; Empirical Phi = 0.0920, Max null Phi = 0.1500, Min null Phi = 0.0423, p-value = 0.51</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; PCA is not significant!</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-2-1.png" width="80%" height="80%"></p>
</div>
<div id="selecting-the-number-of-significant-pcs" class="section level2">
<h2 class="hasAnchor">
<a href="#selecting-the-number-of-significant-pcs" class="anchor"></a>Selecting the number of significant PCs</h2>
<p>If a PCA is significant, PCAtest uses random permutations to test which PC axes are significant based on random permutation and calculation of the percentage of total variation explained by each PC axis. We can use the published dataset from Wong &amp; Carmona (2021, <a href="https://doi.org/10.1111/2041-210X.13568" class="uri">https://doi.org/10.1111/2041-210X.13568</a>) consisting of seven morphological variables measured in 29 ant species:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span>
<span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling bootstrap replicates... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling random permutations... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span>
<span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.6398, Min null Psi = 0.5263, p-value = 0</span>
<span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2507, Min null Phi = 0.1119, p-value = 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.14257, p-value = 0</span>
<span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.72577, p-value = 0.19</span>
<span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.35632, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.10843, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.93889, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.78825, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.66224, p-value = 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:43.5-64.4) of the total variation</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-3-1.png" width="80%" height="80%"></p>
</div>
<div id="testing-which-variables-have-significant-loadings" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-which-variables-have-significant-loadings" class="anchor"></a>Testing which variables have significant loadings</h2>
<p>In addition to selecting the number of significant PC axes, we are usually interested in finding out which variables have significant loadings on each significant PC axis. PCAtest runs random permutations and plots index loadings for all significant PCs:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span>
<span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">TRUE</span>, varcorr<span class="op">=</span><span class="cn">FALSE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling bootstrap replicates... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling random permutations... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span>
<span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.8082, Min null Psi = 0.6499, p-value = 0</span>
<span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2586, Min null Phi = 0.1244, p-value = 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.16597, p-value = 0</span>
<span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.79872, p-value = 0.13</span>
<span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.47698, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.14022, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 1.00708, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.73158, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.5666, p-value = 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:46.1-64.2) of the total variation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variables 1, 2, 3, 4, 5, and 7 have significant loadings on PC 1</span></code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-4-1.png" width="80%" height="80%"></p>
</div>
<div id="testing-which-variables-have-significant-correlations" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-which-variables-have-significant-correlations" class="anchor"></a>Testing which variables have significant correlations</h2>
<p>Instead of index loadings, we can choose to use variable correlations to evaluate their contributions to each significant PC axis:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"ants"</span><span class="op">)</span>
<span class="va">result</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/PCAtest.html">PCAtest</a></span><span class="op">(</span><span class="va">ants</span>, <span class="fl">100</span>, <span class="fl">100</span>, <span class="fl">0.05</span>, indload<span class="op">=</span><span class="cn">FALSE</span>, varcorr<span class="op">=</span><span class="cn">TRUE</span>, counter<span class="op">=</span><span class="cn">FALSE</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling bootstrap replicates... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Calculating confidence intervals of empirical statistics... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sampling random permutations... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Comparing empirical statistics with their null distributions... Please wait</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; Test of PCA significance: 7 variables, 29 observations</span>
<span class="co">#&gt; 100 bootstrap replicates, 100 random permutations</span>
<span class="co">#&gt; ========================================================</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical Psi = 10.9186, Max null Psi = 2.8666, Min null Psi = 0.4841, p-value = 0</span>
<span class="co">#&gt; Empirical Phi = 0.5099, Max null Phi = 0.2613, Min null Phi = 0.1074, p-value = 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Empirical eigenvalue #1 = 3.84712, Max null eigenvalue = 2.26748, p-value = 0</span>
<span class="co">#&gt; Empirical eigenvalue #2 = 1.52017, Max null eigenvalue = 1.75182, p-value = 0.18</span>
<span class="co">#&gt; Empirical eigenvalue #3 = 0.70634, Max null eigenvalue = 1.35095, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #4 = 0.41356, Max null eigenvalue = 1.16354, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #5 = 0.34001, Max null eigenvalue = 0.97197, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #6 = 0.14515, Max null eigenvalue = 0.81667, p-value = 1</span>
<span class="co">#&gt; Empirical eigenvalue #7 = 0.02765, Max null eigenvalue = 0.64208, p-value = 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; PC 1 is significant and accounts for 55% (95%-CI:44.4-63.3) of the total variation</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variables 2, and 3 have significant correlations with PC 1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Arley Camargo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
